---
- hosts: openstack_instances
  connection: local
  gather_facts: false
  roles:
    - openstack_instances

- hosts: openstack_instances
  become: yes
  tasks: 
    - name: remove previous hostname ip binding 
      lineinfile:
        dest: /etc/hosts
        regexp: '^10.2.'
        state: absent 
    - name: configure /etc/hosts files
      lineinfile:
        dest: /etc/hosts
        regexp: '.*{{ inventory_hostname }}$'
        line: "{{ ansible_ssh_host }} {{ inventory_hostname }}"
        state: present
